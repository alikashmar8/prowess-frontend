<div *ngIf="!isLoading">
  <div class="container">
    <div class="main-body">
      <div class="row gutters-sm">
        <div class="col-md-4 mb-3">
          <div class="card">
            <div class="card-body">
              <div class="d-flex flex-column align-items-center text-center">
                <img src="assets/images/user-image.jpg" alt="Admin" class="rounded-circle" width="150">
                <div class="mt-3">
                  <h4>{{customer.name}}</h4>
                  <p class=" mb-1" translate>Status: <span
                      [ngClass]="{'text-success' : customer.isActive,'text-red': !customer.isActive}">{{
                      customer.isActive ? 'active' : 'inactive'}}</span></p>
                  <p class="text-muted font-size-sm">
                    <span *ngIf="isLevel5Allowed">
                      {{customer.address.parent.parent.parent.parent.name}}
                    </span>
                    <span *ngIf="isLevel4Allowed">
                      {{customer.address.parent.parent.parent.name}}
                    </span>
                    <span *ngIf="isLevel3Allowed">
                      {{customer.address.parent.parent.name}}
                    </span>
                    <span *ngIf="isLevel2Allowed">
                      {{customer.address.parent.name}}
                    </span>
                    <span>
                      {{customer.address.name}}
                    </span>
                  </p>
                </div>
              </div>
            </div>
          </div>
          <div class="card mt-3">
            <ul class="list-group list-group-flush">
              <li class="list-group-item d-flex justify-content-between align-items-center flex-wrap">
                <button class="btn btn-info w-100 " (click)="openCustomerItemsModal()" translate>Items</button>
              </li>
              <li class="list-group-item d-flex justify-content-between align-items-center flex-wrap">
                <a class="btn btn-warning text-white w-100" target="__blank"
                  routerLink="/company/customers/{{customer.id}}/edit" translate>
                  <i class="fas fa-pen mr-2"></i>Edit
                </a>
              </li>
            </ul>
          </div>
          <div class="card mt-3 ">
            <h5 class="center-elements m-1" translate>
              Subscribed Plans:
            </h5>
            <ul class="list-group list-group-flush">
              <li *ngFor="let plan of customer.plans"
                class="list-group-item d-flex justify-content-between align-items-center flex-wrap ">
                <button class="btn btn-primary w-100 ">{{plan.name}}</button>
              </li>
            </ul>
          </div>
        </div>
        <div class="col-md-8">
          <div class="card mb-3">
            <div class="card-body">
              <div class="row">
                <div class="col-sm-3">
                  <h6 class="mb-0" translate>Full Name</h6>
                </div>
                <div class="col-sm-9 text-primary">
                  {{customer.name}}
                </div>
              </div>
              <hr>
              <div class="row">
                <div class="col-sm-3">
                  <h6 class="mb-0" translate>Email</h6>
                </div>
                <div class="col-sm-9 text-primary">
                  {{customer.email}}
                </div>
              </div>
              <hr>
              <div class="row">
                <div class="col-sm-3">
                  <h6 class="mb-0" translate>Phone Number:</h6>
                </div>
                <div class="col-sm-9 text-primary">
                  {{customer.phoneNumber}}
                </div>
              </div>
              <hr>
              <div class="row">
                <div class="col-sm-3">
                  <h6 class="mb-0" translate>Payment Date:</h6>
                </div>
                <div class="col-sm-9 text-primary">
                  {{ customer.paymentDate | date: "dd/MM/yyyy" }}
                </div>
              </div>
              <hr>
              <div class="row">
                <div class="col-sm-3">
                  <h6 class="mb-0" translate>Collector</h6>
                </div>
                <div class="col-sm-9 text-primary">
                  {{customer.collector?.name}}
                </div>
              </div>
              <hr>
            </div>
          </div>

          <div class="row gutters-sm">
            <div class="col-sm-12 mb-3">
              <div class="card h-100">
                <div class="card-body">
                  <h6 class="d-flex align-items-center mb-3" translate><i class="text-info mr-2" translate>Last 12
                      months</i>Invoices</h6>
                  <ul class="list-group m-5">
                    <div *ngFor="let invoice of customer.invoices; let i = index">
                      <li class="list-group-item d-flex justify-content-between align-items-center m-1"
                        [ngClass]="{'bg-success' : invoice.isPaid,'bg-danger': !invoice.isPaid}">
                        {{ invoice.dueDate | date: 'MMM-yy'}}:
                        <div class="badge ">
                          <a routerLink="/company/invoices/{{invoice.id}}" style="color: black">
                            <div *ngIf="invoice.isPaid" class="center-elements">
                              {{invoice.collectedBy?.name}}
                              <hr class="m-1 w-100"> {{invoice.collected_at | date:'dd MMM'}}
                            </div>
                            <div *ngIf="!invoice.isPaid" class="center-elements">
                              N/A
                            </div>
                          </a>
                        </div>
                      </li>
                    </div>
                  </ul>
                </div>
              </div>
            </div>
            <div class="col-sm-12 mb-3">
              <div class="card h-100">
                <div class="card-body">
                  <h6 class="d-flex align-items-center mb-3" translate><i class="text-info mr-2"
                      translate>Unpaid</i>Invoices
                  </h6>
                  <table class="table table-striped table-bordered">
                    <thead>
                      <tr>
                        <th>#</th>
                        <th translate>Date</th>
                        <th translate>Amount</th>
                        <th translate>Collector</th>
                        <th translate>Actions</th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr *ngFor="let invoice of customer.unpaidInvoices">
                        <td>
                          <a routerLink="/company/invoices/{{invoice.id}}" style="color: black">
                            {{invoice.id}}
                          </a>
                        </td>
                        <td>
                          {{invoice.dueDate | date:'dd-MM-yyyy'}}
                        </td>
                        <td>
                          {{invoice.total | currency: 'USD':true}}
                        </td>
                        <td>
                          {{customer.collector?.name}}
                        </td>
                        <td>
                          <ul class="action-list"
                            *ngIf="[UserRole.MANAGER, UserRole.SUPERVISOR, UserRole.COLLECTOR].includes(currentUser.role)">
                            <li><a routerLink="/company/invoices/{{invoice.id}}" data-tip="show">
                                <i class="fa fa-eye" style="font-size: 21px!important;"></i></a>
                            </li>
                            <li><a (click)="openCollectModal(invoice.id, invoice.user.name)" data-tip="collect">
                                <i class="fas fa-money-bill-alt" style="font-size: 21px!important;"></i></a>
                            </li>
                            <li><a (click)="openForgiveModal(invoice.id, invoice.user.name)" data-tip="forgive">
                                <i class="fas fa-hand-holding-usd" style="font-size: 21px!important;"></i>
                              </a></li>
                          </ul>
                        </td>
                      </tr>
                    </tbody>
                  </table>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
